#!/bin/bash
### WGBS data processing on EULER

# storage
cd /cluster/project/gdc/shared/p423/WGBS/
# working
cd /cluster/scratch/mwyler/wgbs/


# move all raw reads to 'untrimmed'
mkdir 'untrimmed'
cd /cluster/project/gdc/shared/p423/WGBS/RAW_DATA/ ;  find ./ -name 'BSS*.fastq.gz' -exec cp -prv '{}' '/cluster/scratch/mwyler/wgbs/untrimmed/' ';' ; cd /cluster/scratch/mwyler/wgbs/

# upload second patch (from rawRead folder on HD)
# scp BSS* mwyler@euler.ethz.ch:/cluster/scratch/mwyler/wgbs/untrimmed/

#concatenate file with resequenced libraries
cd untrimmed
cat BSSE_QGF_77738_CC7AVANXX_8_ABR2_3_TTAGGCA_S1_L008_R1_001_MM_1.fastq.gz BSSE_QGF_77738_CBP4JANXX_3_ABR2_3_TTAGGCA_S1_L003_R1_001_MM_1.fastq.gz > BSSE_merged_77738_CC7AVANXX_8_ABR2_3_TTAGGCA_S1_L008_R1_001_MM_1.fastq.gz 
cat BSSE_QGF_77738_CC7AVANXX_8_ABR2_3_TTAGGCA_S1_L008_R2_001_MM_1.fastq.gz BSSE_QGF_77738_CBP4JANXX_3_ABR2_3_TTAGGCA_S1_L003_R2_001_MM_1.fastq.gz > BSSE_merged_77738_CC7AVANXX_8_ABR2_3_TTAGGCA_S1_L008_R2_001_MM_1.fastq.gz ; rm BSSE_QGF_77738_*

cat BSSE_QGF_77743_CC7AVANXX_8_Bd21_3_2_GAGTGGA_S4_L008_R1_001_MM_1.fastq.gz BSSE_QGF_77743_CBP4JANXX_3_Bd21_3_2_GAGTGGA_S6_L003_R1_001_MM_1.fastq.gz > BSSE_merged_77743_CC7AVANXX_8_Bd21_3_2_GAGTGGA_S4_L008_R1_001_MM_1.fastq.gz
cat BSSE_QGF_77743_CC7AVANXX_8_Bd21_3_2_GAGTGGA_S4_L008_R2_001_MM_1.fastq.gz BSSE_QGF_77743_CBP4JANXX_3_Bd21_3_2_GAGTGGA_S6_L003_R2_001_MM_1.fastq.gz > BSSE_merged_77743_CC7AVANXX_8_Bd21_3_2_GAGTGGA_S4_L008_R2_001_MM_1.fastq.gz ; rm BSSE_QGF_77743_*

cat BSSE_QGF_77741_CC7AVANXX_8_Bd21_2_ATGTCAG_S3_L008_R1_001_MM_1.fastq.gz BSSE_QGF_77741_CBP4JANXX_3_Bd21_2_ATGTCAG_S4_L003_R1_001_MM_1.fastq.gz > BSSE_merged_77741_CC7AVANXX_8_Bd21_2_ATGTCAG_S3_L008_R1_001_MM_1.fastq.gz
cat BSSE_QGF_77741_CC7AVANXX_8_Bd21_2_ATGTCAG_S3_L008_R2_001_MM_1.fastq.gz BSSE_QGF_77741_CBP4JANXX_3_Bd21_2_ATGTCAG_S4_L003_R2_001_MM_1.fastq.gz > BSSE_merged_77741_CC7AVANXX_8_Bd21_2_ATGTCAG_S3_L008_R2_001_MM_1.fastq.gz ; rm BSSE_QGF_77741_*

cat BSSE_QGF_77739_CC7AVANXX_8_Bd30_2_GCCAATA_S2_L008_R1_001_MM_1.fastq.gz BSSE_QGF_77739_CBP4JANXX_3_Bd30_2_GCCAATA_S2_L003_R1_001_MM_1.fastq.gz > BSSE_merged_77739_CC7AVANXX_8_Bd30_2_GCCAATA_S2_L008_R1_001_MM_1.fastq.gz
cat BSSE_QGF_77739_CC7AVANXX_8_Bd30_2_GCCAATA_S2_L008_R2_001_MM_1.fastq.gz BSSE_QGF_77739_CBP4JANXX_3_Bd30_2_GCCAATA_S2_L003_R2_001_MM_1.fastq.gz > BSSE_merged_77739_CC7AVANXX_8_Bd30_2_GCCAATA_S2_L008_R2_001_MM_1.fastq.gz ; rm BSSE_QGF_77739_*

cat BSSE_QGF_77749_CBP4JANXX_4_Bd21_1_CCGTCCC_S1_L004_R1_001_MM_1.fastq.gz BSSE_QGF_77749_CC7AVANXX_8_Bd21_1_CCGTCCC_S5_L008_R1_001_MM_1.fastq.gz > BSSE_merged_77749_CC7AVANXX_8_Bd21_1_CCGTCCC_S5_L008_R1_001_MM_1.fastq.gz
cat BSSE_QGF_77749_CBP4JANXX_4_Bd21_1_CCGTCCC_S1_L004_R2_001_MM_1.fastq.gz BSSE_QGF_77749_CC7AVANXX_8_Bd21_1_CCGTCCC_S5_L008_R2_001_MM_1.fastq.gz > BSSE_merged_77749_CC7AVANXX_8_Bd21_1_CCGTCCC_S5_L008_R2_001_MM_1.fastq.gz ; rm BSSE_QGF_77749_*

cat BSSE_QGF_77754_CC7AVANXX_8_Sig2_2_ATCACGA_S6_L008_R1_001_MM_1.fastq.gz BSSE_QGF_77754_CBP4JANXX_4_Sig2_2_ATCACGA_S6_L004_R1_001_MM_1.fastq.gz > BSSE_merged_77754_CC7AVANXX_8_Sig2_2_ATCACGA_S6_L008_R1_001_MM_1.fastq.gz
cat BSSE_QGF_77754_CC7AVANXX_8_Sig2_2_ATCACGA_S6_L008_R2_001_MM_1.fastq.gz BSSE_QGF_77754_CBP4JANXX_4_Sig2_2_ATCACGA_S6_L004_R2_001_MM_1.fastq.gz > BSSE_merged_77754_CC7AVANXX_8_Sig2_2_ATCACGA_S6_L008_R2_001_MM_1.fastq.gz ; rm BSSE_QGF_77754_*


# modify all fastq containing '_' in the sample name (e.g. Koz_3)
mv BSSE_QGF_77764_CBP4JANXX_5_Bd1_1_2_GAGTGGA_S5_L005_R2_001_MM_1.fastq.gz BSSE_QGF_77764_CBP4JANXX_5_Bd1-1_2_GAGTGGA_S5_L005_R2_001_MM_1.fastq.gz
mv BSSE_QGF_77764_CBP4JANXX_5_Bd1_1_2_GAGTGGA_S5_L005_R1_001_MM_1.fastq.gz BSSE_QGF_77764_CBP4JANXX_5_Bd1-1_2_GAGTGGA_S5_L005_R1_001_MM_1.fastq.gz
mv BSSE_QGF_77762_CBP4JANXX_5_Bd30_1_1_GTCCGCA_S3_L005_R2_001_MM_1.fastq.gz BSSE_QGF_77762_CBP4JANXX_5_Bd30-1_1_GTCCGCA_S3_L005_R2_001_MM_1.fastq.gz
mv BSSE_QGF_77762_CBP4JANXX_5_Bd30_1_1_GTCCGCA_S3_L005_R1_001_MM_1.fastq.gz BSSE_QGF_77762_CBP4JANXX_5_Bd30-1_1_GTCCGCA_S3_L005_R1_001_MM_1.fastq.gz
mv BSSE_QGF_77761_CBP4JANXX_5_Bd3_1_3_CAGATCA_S2_L005_R1_001_MM_1.fastq.gz BSSE_QGF_77761_CBP4JANXX_5_Bd3-1_3_CAGATCA_S2_L005_R1_001_MM_1.fastq.gz
mv BSSE_QGF_77761_CBP4JANXX_5_Bd3_1_3_CAGATCA_S2_L005_R2_001_MM_1.fastq.gz BSSE_QGF_77761_CBP4JANXX_5_Bd3-1_3_CAGATCA_S2_L005_R2_001_MM_1.fastq.gz
mv BSSE_QGF_77760_CBP4JANXX_5_Koz_3_2_AGTCAAC_S1_L005_R2_001_MM_1.fastq.gz BSSE_QGF_77760_CBP4JANXX_5_Koz-3_2_AGTCAAC_S1_L005_R2_001_MM_1.fastq.gz
mv BSSE_QGF_77760_CBP4JANXX_5_Koz_3_2_AGTCAAC_S1_L005_R1_001_MM_1.fastq.gz BSSE_QGF_77760_CBP4JANXX_5_Koz-3_2_AGTCAAC_S1_L005_R1_001_MM_1.fastq.gz
mv BSSE_QGF_77759_CBP4JANXX_4_Koz_3_1_GTGAAAC_S11_L004_R2_001_MM_1.fastq.gz BSSE_QGF_77759_CBP4JANXX_4_Koz-3_1_GTGAAAC_S11_L004_R2_001_MM_1.fastq.gz
mv BSSE_QGF_77759_CBP4JANXX_4_Koz_3_1_GTGAAAC_S11_L004_R1_001_MM_1.fastq.gz BSSE_QGF_77759_CBP4JANXX_4_Koz-3_1_GTGAAAC_S11_L004_R1_001_MM_1.fastq.gz
mv BSSE_QGF_77758_CBP4JANXX_4_Bd30_1_3_GTTTCGG_S10_L004_R2_001_MM_1.fastq.gz BSSE_QGF_77758_CBP4JANXX_4_Bd30-1_3_GTTTCGG_S10_L004_R2_001_MM_1.fastq.gz
mv BSSE_QGF_77758_CBP4JANXX_4_Bd30_1_3_GTTTCGG_S10_L004_R1_001_MM_1.fastq.gz BSSE_QGF_77758_CBP4JANXX_4_Bd30-1_3_GTTTCGG_S10_L004_R1_001_MM_1.fastq.gz
mv BSSE_QGF_77756_CBP4JANXX_4_Bd21_3_1_ACTTGAA_S8_L004_R2_001_MM_1.fastq.gz BSSE_QGF_77756_CBP4JANXX_4_Bd21-3_1_ACTTGAA_S8_L004_R2_001_MM_1.fastq.gz
mv BSSE_QGF_77756_CBP4JANXX_4_Bd21_3_1_ACTTGAA_S8_L004_R1_001_MM_1.fastq.gz BSSE_QGF_77756_CBP4JANXX_4_Bd21-3_1_ACTTGAA_S8_L004_R1_001_MM_1.fastq.gz
mv BSSE_QGF_77753_CBP4JANXX_4_Bd1_1_3_AGTCAAC_S5_L004_R2_001_MM_1.fastq.gz BSSE_QGF_77753_CBP4JANXX_4_Bd1-1_3_AGTCAAC_S5_L004_R2_001_MM_1.fastq.gz
mv BSSE_QGF_77753_CBP4JANXX_4_Bd1_1_3_AGTCAAC_S5_L004_R1_001_MM_1.fastq.gz BSSE_QGF_77753_CBP4JANXX_4_Bd1-1_3_AGTCAAC_S5_L004_R1_001_MM_1.fastq.gz
mv BSSE_QGF_77751_CBP4JANXX_4_Bd3_1_2_GTCCGCA_S3_L004_R2_001_MM_1.fastq.gz BSSE_QGF_77751_CBP4JANXX_4_Bd3-1_2_GTCCGCA_S3_L004_R2_001_MM_1.fastq.gz
mv BSSE_QGF_77751_CBP4JANXX_4_Bd3_1_2_GTCCGCA_S3_L004_R1_001_MM_1.fastq.gz BSSE_QGF_77751_CBP4JANXX_4_Bd3-1_2_GTCCGCA_S3_L004_R1_001_MM_1.fastq.gz
mv BSSE_QGF_77748_CBP4JANXX_3_Bd1_1_1_CGTACGT_S11_L003_R2_001_MM_1.fastq.gz BSSE_QGF_77748_CBP4JANXX_3_Bd1-1_1_CGTACGT_S11_L003_R2_001_MM_1.fastq.gz
mv BSSE_QGF_77748_CBP4JANXX_3_Bd1_1_1_CGTACGT_S11_L003_R1_001_MM_1.fastq.gz BSSE_QGF_77748_CBP4JANXX_3_Bd1-1_1_CGTACGT_S11_L003_R1_001_MM_1.fastq.gz
mv BSSE_QGF_77746_CBP4JANXX_3_Bd3_1_1_CCGTCCC_S9_L003_R2_001_MM_1.fastq.gz BSSE_QGF_77746_CBP4JANXX_3_Bd3-1_1_CCGTCCC_S9_L003_R2_001_MM_1.fastq.gz
mv BSSE_QGF_77746_CBP4JANXX_3_Bd3_1_1_CCGTCCC_S9_L003_R1_001_MM_1.fastq.gz BSSE_QGF_77746_CBP4JANXX_3_Bd3-1_1_CCGTCCC_S9_L003_R1_001_MM_1.fastq.gz
mv BSSE_QGF_77744_CBP4JANXX_3_Koz_3_3_GTTTCGG_S7_L003_R2_001_MM_1.fastq.gz BSSE_QGF_77744_CBP4JANXX_3_Koz-3_3_GTTTCGG_S7_L003_R2_001_MM_1.fastq.gz
mv BSSE_QGF_77744_CBP4JANXX_3_Koz_3_3_GTTTCGG_S7_L003_R1_001_MM_1.fastq.gz BSSE_QGF_77744_CBP4JANXX_3_Koz-3_3_GTTTCGG_S7_L003_R1_001_MM_1.fastq.gz
mv BSSE_merged_77743_CC7AVANXX_8_Bd21_3_2_GAGTGGA_S4_L008_R2_001_MM_1.fastq.gz BSSE_merged_77743_CC7AVANXX_8_Bd21-3_2_GAGTGGA_S4_L008_R2_001_MM_1.fastq.gz
mv BSSE_merged_77743_CC7AVANXX_8_Bd21_3_2_GAGTGGA_S4_L008_R1_001_MM_1.fastq.gz BSSE_merged_77743_CC7AVANXX_8_Bd21-3_2_GAGTGGA_S4_L008_R1_001_MM_1.fastq.gz
mv BSSE_merged_77739_CC7AVANXX_8_Bd30_2_GCCAATA_S2_L008_R1_001_MM_1.fastq.gz BSSE_merged_77739_CC7AVANXX_8_Bd30-1_2_GCCAATA_S2_L008_R1_001_MM_1.fastq.gz
mv BSSE_merged_77739_CC7AVANXX_8_Bd30_2_GCCAATA_S2_L008_R2_001_MM_1.fastq.gz BSSE_merged_77739_CC7AVANXX_8_Bd30-1_2_GCCAATA_S2_L008_R2_001_MM_1.fastq.gz
mv BSSE_QGF_77765_CBP4JANXX_5_Bd21_3_3_AGTTCCG_S6_L005_R2_001_MM_1.fastq.gz BSSE_QGF_77765_CBP4JANXX_5_Bd21-3_3_AGTTCCG_S6_L005_R2_001_MM_1.fastq.gz
mv BSSE_QGF_77765_CBP4JANXX_5_Bd21_3_3_AGTTCCG_S6_L005_R1_001_MM_1.fastq.gz BSSE_QGF_77765_CBP4JANXX_5_Bd21-3_3_AGTTCCG_S6_L005_R1_001_MM_1.fastq.gz

# syncronize the merged files
bsub 'zcat BSSE_merged_77738_CC7AVANXX_8_ABR2_3_TTAGGCA_S1_L008_R1_001_MM_1.fastq.gz > BSSE_merged_77738_CC7AVANXX_8_ABR2_3_TTAGGCA_S1_L008_R1_001_MM_1.fastq; zcat BSSE_merged_77738_CC7AVANXX_8_ABR2_3_TTAGGCA_S1_L008_R2_001_MM_1.fastq.gz > BSSE_merged_77738_CC7AVANXX_8_ABR2_3_TTAGGCA_S1_L008_R2_001_MM_1.fastq ; ../SCRIPTS/sync-illumina-pe-files.pl -f BSSE_merged_77738_CC7AVANXX_8_ABR2_3_TTAGGCA_S1_L008_R1_001_MM_1.fastq -r BSSE_merged_77738_CC7AVANXX_8_ABR2_3_TTAGGCA_S1_L008_R2_001_MM_1.fastq -v 1.8 -o BSSE_merged_77738_CC7AVANXX_8_ABR2_3'

bsub 'zcat BSSE_merged_77739_CC7AVANXX_8_Bd30-1_2_GCCAATA_S2_L008_R1_001_MM_1.fastq.gz > BSSE_merge_77739_CC7AVANXX_8_Bd30-1_2_GCCAATA_S2_L008_R1_001_MM_1.fastq ; zcat BSSE_merged_77739_CC7AVANXX_8_Bd30-1_2_GCCAATA_S2_L008_R2_001_MM_1.fastq.gz > BSSE_merge_77739_CC7AVANXX_8_Bd30-1_2_GCCAATA_S2_L008_R2_001_MM_1.fastq ; ../SCRIPTS/sync-illumina-pe-files.pl -f BSSE_merge_77739_CC7AVANXX_8_Bd30-1_2_GCCAATA_S2_L008_R1_001_MM_1.fastq -r BSSE_merge_77739_CC7AVANXX_8_Bd30-1_2_GCCAATA_S2_L008_R2_001_MM_1.fastq -v 1.8 -o BSSE_merge_77739_CC7AVANXX_8_Bd30-1_2'

bsub 'zcat BSSE_merged_77749_CC7AVANXX_8_Bd21_1_CCGTCCC_S5_L008_R1_001_MM_1.fastq.gz > BSSE_merge_77749_CC7AVANXX_8_Bd21_1_CCGTCCC_S5_L008_R1_001_MM_1.fastq ; zcat BSSE_merged_77749_CC7AVANXX_8_Bd21_1_CCGTCCC_S5_L008_R2_001_MM_1.fastq.gz > BSSE_merge_77749_CC7AVANXX_8_Bd21_1_CCGTCCC_S5_L008_R2_001_MM_1.fastq ;../SCRIPTS/sync-illumina-pe-files.pl -f BSSE_merge_77749_CC7AVANXX_8_Bd21_1_CCGTCCC_S5_L008_R1_001_MM_1.fastq -r BSSE_merge_77749_CC7AVANXX_8_Bd21_1_CCGTCCC_S5_L008_R2_001_MM_1.fastq -v 1.8 -o BSSE_merge_77749_CC7AVANXX_8_Bd21_1'


bsub 'zcat BSSE_merged_77754_CC7AVANXX_8_Sig2_2_ATCACGA_S6_L008_R1_001_MM_1.fastq.gz > BSSE_merge_77754_CC7AVANXX_8_Sig2_2_ATCACGA_S6_L008_R1_001_MM_1.fastq ; zcat BSSE_merged_77754_CC7AVANXX_8_Sig2_2_ATCACGA_S6_L008_R2_001_MM_1.fastq.gz >  BSSE_merge_77754_CC7AVANXX_8_Sig2_2_ATCACGA_S6_L008_R2_001_MM_1.fastq; ../SCRIPTS/sync-illumina-pe-files.pl -f BSSE_merge_77754_CC7AVANXX_8_Sig2_2_ATCACGA_S6_L008_R1_001_MM_1.fastq -r BSSE_merge_77754_CC7AVANXX_8_Sig2_2_ATCACGA_S6_L008_R2_001_MM_1.fastq -v 1.8 -o BSSE_merge_77754_CC7AVANXX_8_Sig2_2'


bsub 'zcat BSSE_merged_77741_CC7AVANXX_8_Bd21_2_ATGTCAG_S3_L008_R1_001_MM_1.fastq.gz > BSSE_merged_77741_CC7AVANXX_8_Bd21_2_ATGTCAG_S3_L008_R1_001_MM_1.fastq ; zcat BSSE_merged_77741_CC7AVANXX_8_Bd21_2_ATGTCAG_S3_L008_R2_001_MM_1.fastq.gz > BSSE_merged_77741_CC7AVANXX_8_Bd21_2_ATGTCAG_S3_L008_R2_001_MM_1.fastq; ../SCRIPTS/sync-illumina-pe-files.pl -f BSSE_merged_77741_CC7AVANXX_8_Bd21_2_ATGTCAG_S3_L008_R1_001_MM_1.fastq -r BSSE_merged_77741_CC7AVANXX_8_Bd21_2_ATGTCAG_S3_L008_R2_001_MM_1.fastq -v 1.8 -o BSSE_merged_77741_CC7AVANXX_8_Bd21_2'

bsub 'zcat BSSE_merged_77743_CC7AVANXX_8_Bd21-3_2_GAGTGGA_S4_L008_R1_001_MM_1.fastq.gz > BSSE_merged_77743_CC7AVANXX_8_Bd21-3_2_GAGTGGA_S4_L008_R1_001_MM_1.fastq ; zcat BSSE_merged_77743_CC7AVANXX_8_Bd21-3_2_GAGTGGA_S4_L008_R2_001_MM_1.fastq.gz > BSSE_merged_77743_CC7AVANXX_8_Bd21-3_2_GAGTGGA_S4_L008_R2_001_MM_1.fastq ; ../SCRIPTS/sync-illumina-pe-files.pl -f BSSE_merged_77743_CC7AVANXX_8_Bd21-3_2_GAGTGGA_S4_L008_R1_001_MM_1.fastq -r BSSE_merged_77743_CC7AVANXX_8_Bd21-3_2_GAGTGGA_S4_L008_R2_001_MM_1.fastq -v 1.8 -o BSSE_merged_77743_CC7AVANXX_8_Bd21-3_2'

bsub 'for FILE in *77749*.gz *77743*.gz *77741*.gz *77739*.gz *77754*.gz *77738*.gz ; do rm ${FILE}; done'
bsub 'parallel -j6 "gzip BSSE_mer*{}*R1*.fastq" ::: 77749 77743 77741 77739 77754 77738'
bsub 'parallel -j6 "gzip BSSE_mer*{}*R2*.fastq" ::: 77749 77743 77741 77739 77754 77738'

rm lsf.*; rm *.fastq
cd /cluster/scratch/mwyler/wgbs/


# trimming with TRIM_GALORE!
mkdir trimmed
ls -1 untrimmed/*_R1* | sed 's/_R1_001_MM_1.fastq.gz//g' | grep "Undetermined" -v | awk -F"_" '{print $6"_"$7}' > nomiTrimming.txt
bsub -N -R "rusage[mem=2048]" -W 18:00  -o trimming_log.%J.%I  -e trimming_err.%J.%I -J "trim[1-33]%33" /cluster/scratch/mwyler/wgbs/SCRIPTS/TRIMMING

# genome preparation/p423/r_ref/
mkdir GENOME ; zcat /cluster/project/gdc/shared/p423/r_ref/Bdistachyon_314_v3.0.fa.gz > GENOME/Bdis_v3.fa
bsub -N 'module load gcc/4.8.2 gdc perl/5.18.4 bowtie2/2.3.2 samtools/1.3 bismark/0.19.0 ; bismark_genome_preparation --bowtie2 GENOME/'

# mapping with Bismark
mkdir mapped
ls -1 trimmed/*_R1_*fq.gz | sed 's/_R1_001_MM_1_val_1.fq.gz//g' | grep "Undetermined" -v | awk -F"_" '{print $6"_"$7}' > nomiMapping.txt
bsub -N -n 8 -R "rusage[mem=2048]" -W 08:00  -o mapping_log.%J.%I  -e mapping_err.%J.%I -J "bismark[1-33]%6" /cluster/scratch/mwyler/wgbs/SCRIPTS/MAPPING

# deduplication with bismark script
mkdir deduplicatedBAM
find mapped/ -type f -name "*.bam" > nomiDeduplication.txt
bsub -N -R "rusage[mem=4048]" -W 08:00  -o deduplication_log.%J.%I  -e deduplication_err.%J.%I -J "deduplication[1-33]%20" /cluster/scratch/mwyler/wgbs/SCRIPTS/DEDUPLICATION

## extract first only MBIAS plots
mkdir mbias
bsub -N -R "rusage[mem=2048]" -W 10:00  -o plot_log.%J.%I  -e plot_err.%J.%I -J "plotting[1-33]%33" /cluster/scratch/mwyler/wgbs/SCRIPTS/MBIAS

## extract C
mkdir extracted
bsub -N -R "rusage[mem=2048]" -W 24:00  -o extract_log.%J.%I  -e extract_err.%J.%I -J "extract[1-33]%33" /cluster/scratch/mwyler/wgbs/SCRIPTS/EXTRACTOR

## transform files
mkdir fullExtract
bsub -N -R "rusage[mem=2048]" -W 14:00  -o conversion_log.%J.%I  -e conversion_err.%J.%I -J "conversion[1-99]%33" /cluster/scratch/mwyler/wgbs/SCRIPTS/BISMARK2COVERAGE


